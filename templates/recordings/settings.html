{% extends 'base.html' %}

{% block title %}Настройки{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Настройки</h1>
    <p>Управление настройками аккаунта</p>
</div>

<div class="card">
    <div class="card-header">
        <h3>Настройки записи</h3>
    </div>
    <div class="card-body">
        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}
        
        <form method="post" style="max-width: 500px;">
            {% csrf_token %}
            
            <div class="form-group">
                <label for="id_default_recognition_service" class="form-label">Библиотека распознавания по умолчанию</label>
                <select id="id_default_recognition_service" name="default_recognition_service" class="form-select">
                    {% for value, label in form.default_recognition_service.field.choices %}
                        <option value="{{ value }}" {% if form.default_recognition_service.value == value %}selected{% endif %}>{{ label }}</option>
                    {% endfor %}
                </select>
                <div style="color: var(--text-muted); font-size: 0.8125rem; margin-top: 0.5rem;">
                    Библиотека, которая будет использоваться по умолчанию при загрузке новых записей
                </div>
            </div>
            
            <div class="form-group" id="settings-whisper-model-group">
                <label for="id_default_whisper_model" class="form-label">Модель Whisper по умолчанию</label>
                <select id="id_default_whisper_model" name="default_whisper_model" class="form-select">
                    {% for value, label in form.default_whisper_model.field.choices %}
                        <option value="{{ value }}" {% if form.default_whisper_model.value == value %}selected{% endif %}>{{ label }}</option>
                    {% endfor %}
                </select>
                <div style="color: var(--text-muted); font-size: 0.8125rem; margin-top: 0.5rem;">
                    Используется только для библиотек Whisper и Faster-Whisper
                </div>
            </div>
            
            <div class="form-group" id="settings-vosk-model-group" style="display: none;">
                <label for="id_default_vosk_model" class="form-label">Модель Vosk по умолчанию</label>
                <select id="id_default_vosk_model" name="default_vosk_model" class="form-select">
                    <option value="">-- Не выбрано --</option>
                    {% for model_id, model_info in vosk_models %}
                        <option value="{{ model_id }}" {% if form.default_vosk_model.value == model_id %}selected{% endif %}>
                            {{ model_info.name }} ({{ model_info.size }})
                        </option>
                    {% endfor %}
                </select>
                <div style="color: var(--text-muted); font-size: 0.8125rem; margin-top: 0.5rem;">
                    Используется только для библиотеки Vosk
                </div>
            </div>
            
            <div class="form-group">
                <label style="display: flex; align-items: center; gap: 0.75rem; cursor: pointer; padding: 0.875rem 1rem; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: var(--radius-sm);">
                    <input type="checkbox" id="id_auto_transcribe" name="auto_transcribe" {% if form.auto_transcribe.value %}checked{% endif %} style="width: 18px; height: 18px; cursor: pointer;">
                    <span style="color: var(--text-primary); font-weight: 500;">{{ form.auto_transcribe.label }}</span>
                </label>
                <div style="color: var(--text-muted); font-size: 0.8125rem; margin-top: 0.5rem; margin-left: 2.25rem;">
                    Автоматически распознавать текст после загрузки записи
                </div>
            </div>
            
            <div class="form-group">
                <label for="id_language" class="form-label">Язык распознавания</label>
                <input type="text" id="id_language" name="language" class="form-input" value="{{ form.language.value }}" placeholder="ru">
                <div style="color: var(--text-muted); font-size: 0.8125rem; margin-top: 0.25rem;">
                    Код языка для распознавания (например: ru, en)
                </div>
            </div>
            
            <div style="margin-top: 2rem;">
                <button type="submit" class="button button-primary button-large">Сохранить настройки</button>
            </div>
        </form>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <h3>Аккаунт</h3>
    </div>
    <div class="card-body">
        <div style="display: flex; flex-direction: column; gap: 1rem;">
            <div>
                <div style="color: var(--text-secondary); font-size: 0.875rem; margin-bottom: 0.25rem;">Имя пользователя</div>
                <div style="color: var(--text-primary); font-size: 1rem; font-weight: 500;">{{ user.username }}</div>
            </div>
            <div>
                <div style="color: var(--text-secondary); font-size: 0.875rem; margin-bottom: 0.25rem;">Email</div>
                <div style="color: var(--text-primary); font-size: 1rem;">{{ user.email|default:"Не указан" }}</div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
